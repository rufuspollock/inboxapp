# Release Automation Design

**Goal:** Automate macOS DMG releases via GitHub Actions, driven by Conventional Commits and Release Please, with documentation in README.

**Context:** Releases are currently manual: bump versions locally, update changelog, build DMG, tag, and upload. We want a repeatable workflow that generates changelog + tags and uploads the DMG on release.

## Requirements

- Use Conventional Commits on merges to `main`.
- Use Release Please on `main` to:
  - Open/refresh a release PR
  - Bump versions in `package.json`, `src-tauri/tauri.conf.json`, and `src-tauri/Cargo.toml`
  - Update `CHANGELOG.md`
  - Create a GitHub Release + tag when the release PR is merged
- Build the DMG on GitHub Actions for each published release and upload it as a release asset.
- Keep `main` as the release source; development continues in branches merged into `main`.
- Document the release flow in README.
- No signing/notarization in this phase.

## Approach

- Add Release Please configuration in `.github/release-please-config.json` and `.github/release-please-manifest.json`.
  - Single-package config that maps the version to `package.json` and uses `extra-files` to bump the Tauri config and Cargo files.
  - Changelog generated from Conventional Commit types.
- Add GitHub Actions workflow `release-please.yml` on `push` to `main` using `google-github-actions/release-please-action`.
- Add GitHub Actions workflow `build-dmg.yml` on `release.published`.
  - Uses `macos-latest` runner, installs Node + Rust, runs `npm install`, `npm run build`.
  - Uploads `src-tauri/target/release/bundle/dmg/*.dmg` to the release as assets.
- Update README with a short "Release Flow" section covering:
  - Conventional Commits
  - Release Please PR creation
  - Merge PR to publish release (tag + notes)
  - DMG automatically attached

## Open Questions

- None (use `vX.Y.Z` tags generated by Release Please).

## Testing

- CI workflows validate release automation on tag events.
- Locally, `npm test` and `npm run build` remain available.
